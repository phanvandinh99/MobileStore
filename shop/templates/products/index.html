{% extends 'layout.html' %} {% block head %}
<link
  href="{{ url_for('static', filename='css/products.css') }}"
  rel="stylesheet"
/>
{% endblock %} {% block content %}

<!-- Products Section -->
<section id="products" class="products-section">
  <div class="container">
    <div class="section-header text-center mb-5">
      <h2 class="section-title">Sản Phẩm Nổi Bật</h2>
      <p class="section-subtitle" style="margin: auto">
        Khám phá bộ sưu tập điện thoại và phụ kiện chất lượng cao
      </p>
    </div>

    <div class="row">
      {% for product in products.items %}
      <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
        <div class="product-card">
          <div class="product-image">
            <img
              src="{{url_for('static', filename='images/' + product.image_1)}}"
              alt="{{product.name}}"
              class="img-fluid"
            />
            <div class="product-overlay">
              <div class="overlay-buttons">
                <a
                  href="{{url_for('detail', id = product.id)}}"
                  class="btn btn-outline-light btn-sm"
                >
                  <i class="fa fa-eye"></i> Xem chi tiết
                </a>
              </div>
            </div>
            {% if product.discount > 0 %}
            <div class="discount-badge">-{{product.discount}}%</div>
            {% endif %}
          </div>
          <div class="product-info">
            <a href="{{url_for('detail', id = product.id)}}">
                <h4 class="product-title">{{product.name}}</h4>
            </a>
            <div class="product-price">
              {% if product.discount > 0 %}
              <span class="original-price">{{product.price | vnd}}</span>
              <span class="current-price"
                >{{(product.price * (100 - product.discount) / 100) |
                vnd}}</span
              >
              {% else %}
              <span class="current-price">{{product.price | vnd}}</span>
              {% endif %}
            </div>
            <div class="product-meta">
              <span
                class="stock-status {% if product.stock > 0 %}in-stock{% else %}out-of-stock{% endif %}"
              >
                {% if product.stock > 0 %}
                <i class="fa fa-check-circle"></i> Còn hàng {% else %}
                <i class="fa fa-times-circle"></i> Hết hàng {% endif %}
              </span>
            </div>
            <div class="product-actions">
              <div class="row">
                <div class="col-6">
                  {% if product.stock > 0 %}
                  <form
                    action="{{url_for('AddCart')}}"
                    method="post"
                    class="add-to-cart-form"
                  >
                    <input
                      type="hidden"
                      name="product_id"
                      value="{{product.id}}"
                    />
                    <input type="hidden" name="quantity" value="1" />
                    {% set colors = product.colors.split(',') %}
                    <select name="colors" style="display: none">
                      {% for color in colors %} {% set col = color.split(':') %}
                      <option value="{{col[0]}}">
                        {{col[0] | capitalize }}
                      </option>
                      {% endfor %}
                    </select>
                    <button type="submit" class="btn btn-primary btn-block">
                      <i class="fa fa-shopping-cart"></i> Thêm vào giỏ
                    </button>
                  </form>
                  {% else %}
                  <button class="btn btn-secondary btn-block" disabled>
                    <i class="fa fa-times-circle"></i> Hết hàng
                  </button>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if products.pages > 1 %}
    <div class="pagination-wrapper text-center mt-5">
      <nav aria-label="Product pagination">
        <ul class="pagination justify-content-center">
          {% if products.has_prev %}
          <li class="page-item">
            <a
              class="page-link"
              href="{{ url_for('home', page=products.prev_num) }}"
            >
              <i class="fa fa-chevron-left"></i>
            </a>
          </li>
          {% endif %} {% for page_num in products.iter_pages() %} {% if page_num
          %} {% if page_num != products.page %}
          <li class="page-item">
            <a class="page-link" href="{{ url_for('home', page=page_num) }}"
              >{{ page_num }}</a
            >
          </li>
          {% else %}
          <li class="page-item active">
            <span class="page-link">{{ page_num }}</span>
          </li>
          {% endif %} {% else %}
          <li class="page-item disabled">
            <span class="page-link">...</span>
          </li>
          {% endif %} {% endfor %} {% if products.has_next %}
          <li class="page-item">
            <a
              class="page-link"
              href="{{ url_for('home', page=products.next_num) }}"
            >
              <i class="fa fa-chevron-right"></i>
            </a>
          </li>
          {% endif %}
        </ul>
      </nav>
    </div>
    {% endif %}
  </div>
</section>

<!-- Features Section -->
<section class="features-section">
  <div class="container">
    <div class="row">
      <div class="col-md-3 col-sm-6">
        <div class="feature-item text-center">
          <div class="feature-icon">
            <i class="fa fa-truck"></i>
          </div>
          <h5>Giao hàng nhanh</h5>
          <p>Giao hàng toàn quốc trong 24h</p>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="feature-item text-center">
          <div class="feature-icon">
            <i class="fa fa-shield"></i>
          </div>
          <h5>Bảo hành chính hãng</h5>
          <p>Bảo hành 12-24 tháng</p>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="feature-item text-center">
          <div class="feature-icon">
            <i class="fa fa-undo"></i>
          </div>
          <h5>Đổi trả dễ dàng</h5>
          <p>30 ngày đổi trả miễn phí</p>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="feature-item text-center">
          <div class="feature-icon">
            <i class="fa fa-phone"></i>
          </div>
          <h5>Hỗ trợ 24/7</h5>
          <p>Tư vấn và hỗ trợ mọi lúc</p>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Smooth scroll for anchor links
  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute("href"));
      if (target) {
        target.scrollIntoView({
          behavior: "smooth",
          block: "start",
        });
      }
    });
  });
</script>

{% endblock %}
